schema: '2.0'
stages:
  load_data:
    cmd: python src/stage_01_load_and_save.py --config=params.yaml
    deps:
    - path: src/stage_01_load_and_save.py
      md5: e80ec9657f726ec8d867f08c8312d5e8
      size: 1208
    - path: src/utils/common_utils.py
      md5: e05893d4b846dd710b56f85ca3406e17
      size: 1221
    params:
      params.yaml:
        artifacts.raw_local_data: artifacts/raw_local_data_dir/data.csv
        data_source.s3_source: hour.csv
    outs:
    - path: artifacts/raw_local_data_dir/data.csv
      md5: 9ed2fd9aa18e6c14fec2c049c7ef432e
      size: 57571
  split_data:
    cmd: python src/stage_02_split_data.py --config=params.yaml
    deps:
    - path: artifacts/raw_local_data_dir/data.csv
      md5: 9ed2fd9aa18e6c14fec2c049c7ef432e
      size: 57571
    - path: src/stage_02_split_data.py
      md5: 4efb3a2839036c7f1209cca8d74f4631
      size: 1487
    - path: src/utils/common_utils.py
      md5: e05893d4b846dd710b56f85ca3406e17
      size: 1221
    params:
      params.yaml:
        artifacts.raw_local_data: artifacts/raw_local_data_dir/data.csv
        artifacts.split_data.processed_data_dir: artifacts/processed_data
        artifacts.split_data.test_path: artifacts/processed_data/test.csv
        artifacts.split_data.train_path: artifacts/processed_data/train.csv
        base.random_state: 42
        base.test_size: 0.2
    outs:
    - path: artifacts/processed_data/test.csv
      md5: dcdd236238fdadc4ba079b432b632abc
      size: 11667
    - path: artifacts/processed_data/train.csv
      md5: 803d238abd4f811f1d4a377fe6a0dba8
      size: 46020
  evaluate:
    cmd: python src/stage_04_evaluate.py --config=params.yaml
    deps:
    - path: artifacts/processed_data/test.csv
      md5: dcdd236238fdadc4ba079b432b632abc
      size: 11667
    - path: artifacts/saved_models/model.joblib
      md5: 91c46337cd369048ea2e21617f027e24
      size: 1223
    - path: src/stage_04_evaluate.py
      md5: bebbab04cea80b61bb5528b9a4f1472a
      size: 1666
    - path: src/utils/common_utils.py
      md5: e05893d4b846dd710b56f85ca3406e17
      size: 1221
    params:
      params.yaml:
        artifacts.split_data.test_path: artifacts/processed_data/test.csv
        base.target_col: cnt
    outs:
    - path: artifacts/report/scores.json
      md5: 01e4e0a4c4484a71211f54f4a918f096
      size: 104
  get_data:
    cmd: python src/stage_01_get_data.py --config=configs/config.yaml
    deps:
    - path: configs/config.yaml
      md5: b2b2cf5909b0d9670884c2c73e839f66
      size: 556
    - path: src/stage_01_get_data.py
      md5: 55a0d2eba3f0dea85f75e6b0bb6e482b
      size: 1520
    - path: src/utils/common.py
      md5: 154a0d93a4a3eb93f2b4b9c11f646442
      size: 2013
    outs:
    - path: data/cat
      md5: 98d92f6463c18290138e772e3b25e930.dir
      size: 391512992
      nfiles: 12491
    - path: data/dog
      md5: be4f971210f4977c9417b72611457e5b.dir
      size: 472921283
      nfiles: 12470
  prepare_base_model:
    cmd: python src/stage_02_prepare_base_model.py --config=configs/config.yaml --params=params.yaml
    deps:
    - path: configs/config.yaml
      md5: b2b2cf5909b0d9670884c2c73e839f66
      size: 556
    - path: src/stage_02_prepare_base_model.py
      md5: d9ba00d8e6f04e35b8a3d208d782818f
      size: 2338
    - path: src/utils/common.py
      md5: 154a0d93a4a3eb93f2b4b9c11f646442
      size: 2013
    - path: src/utils/model.py
      md5: ed97ef56653e00694474d9f1cffcb00f
      size: 3422
    params:
      params.yaml:
        IMAGE_SIZE:
        - 224
        - 224
        - 3
        LEARNING_RATE: 0.001
    outs:
    - path: artifacts/base_model/base_model.h5
      md5: bb38437b203f5f40c079c93ea13c41ee
      size: 58920424
    - path: artifacts/base_model/updated_base_model.h5
      md5: e7aeb61bfa8e3c3f666aba5d37cfc803
      size: 59134136
  prepare_callback:
    cmd: python src/stage_03_prepare_callback.py --config=configs/config.yaml
    deps:
    - path: configs/config.yaml
      md5: b2b2cf5909b0d9670884c2c73e839f66
      size: 556
    - path: params.yaml
      md5: 4daabf3818c64c80a486b702db49f4a1
      size: 216
    - path: src/stage_03_prepare_callback.py
      md5: 978bdbeaf89646e19616d7b0dfaa1b28
      size: 1804
    - path: src/utils/callbacks.py
      md5: fff78e26ff5443e4188156b46bf140da
      size: 2167
    - path: src/utils/common.py
      md5: 154a0d93a4a3eb93f2b4b9c11f646442
      size: 2013
    outs:
    - path: artifacts/callbacks/checkpoint_cb.cb
      md5: d84f295f3402d4577005ca198f601456
      size: 723
    - path: artifacts/callbacks/tensorboard_cb.cb
      md5: a87897a632d7e0b48edc8df38d83ad4c
      size: 572
